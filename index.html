<!DOCTYPE html>
<html>
<head>
    <title>Registro de Viajes</title>
</head>
<body>
    <h1>Registro de Viajes</h1>
    
    <form id="travel-form">
        <label for="name">Nombre: </label>
        <input type="text" id="name" required><br>

        <label for="date">Fecha:</label>
        <input type="date" id="date" required><br>
        
        <label for="kilometers">Kilómetros:</label>
        <input type="number" id="kilometers" step="0.1" required><br>
        
        <button type="submit">Registrar Viaje</button>
    </form>
    
    <ul id="travel-list"></ul>


    <!-- <p id="total-kilometers">Total de Kilómetros: 0</p> -->

    <script>
        const nameInput = document.getElementById('name')
        const travelForm = document.getElementById('travel-form');
        const dateInput = document.getElementById('date');
        const kilometersInput = document.getElementById('kilometers');
        const travelList = document.getElementById('travel-list');
        
        // Cargar registros al inicio
        window.onload = () => {
            loadTravelRecords();
        };
        
        // Agregar evento al formulario
        travelForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const name = nameInput.value;
            const date = dateInput.value;
            const kilometers = kilometersInput.value;
            saveTravelRecord(name, date, kilometers);
            loadTravelRecords();
            travelForm.reset();
        });
        
        // Guardar registro en Local Storage
        function saveTravelRecord(date, kilometers) {
            const record = { name, date, kilometers };
            const records = JSON.parse(localStorage.getItem('travelRecords')) || [];
            records.push(record);
            localStorage.setItem('travelRecords', JSON.stringify(records));
            updateAfterChanges();
        }
        
        // Cargar registros desde Local Storage
        function loadTravelRecords() {
            travelList.innerHTML = '';
            const records = JSON.parse(localStorage.getItem('travelRecords')) || [];
            records.forEach((record) => {
                const li = document.createElement('li');
                li.textContent = `Nombre: ${record.name} Fecha: ${record.date}, Kilómetros: ${record.kilometers}`;
                travelList.appendChild(li);
            });
        }

        // Función para eliminar un registro
    function deleteTravelRecord(index) {
        const records = JSON.parse(localStorage.getItem('travelRecords')) || [];
        records.splice(index, 1);
        localStorage.setItem('travelRecords', JSON.stringify(records));
        loadTravelRecords();
        updateAfterChanges();
    }

    // Función para cargar registros con opciones de edición y eliminación
    function loadTravelRecords() {
        travelList.innerHTML = '';
        const records = JSON.parse(localStorage.getItem('travelRecords')) || [];
        records.forEach((record, index) => {
            const li = document.createElement('li');
            li.innerHTML = `
                Nombre: ${record.name}, Fecha: ${record.date}, Kilómetros: ${record.kilometers}
                <button onclick="editTravelRecord(${index})">Editar</button>
                <button onclick="deleteTravelRecord(${index})">Eliminar</button>
            `;
            travelList.appendChild(li);
        });
    }

    // Función para editar un registro
    function editTravelRecord(index) {
        const records = JSON.parse(localStorage.getItem('travelRecords')) || [];
        const record = records[index];
        if (record) {
            nombreInput.value = record.name;
            dateInput.value = record.date;
            kilometersInput.value = record.kilometers;
            deleteTravelRecord(index);  // Elimina el registro existente para ser reemplazado
        }
    }

    // Cargar registros al inicio
    window.onload = () => {
        loadTravelRecords();
        // calculateTotalKilometers();
    };
    
    // Función para cargar registros con opciones de edición y eliminación
    function loadTravelRecords() {
        travelList.innerHTML = '';
        const records = JSON.parse(localStorage.getItem('travelRecords')) || [];
        records.forEach((record, index) => {
            const li = document.createElement('li');
            li.innerHTML = `
                Nombre: ${record.name}, Fecha: ${record.date}, Kilómetros: ${record.kilometers}
                <button onclick="editTravelRecord(${index})">Editar</button>
                <button onclick="deleteTravelRecord(${index})">Eliminar</button>
            `;
            travelList.appendChild(li);
        });
    }

    // Función para calcular y mostrar el total de kilómetros
    // function calculateTotalKilometers() {
    //     const records = JSON.parse(localStorage.getItem('travelRecords')) || [];
    //     const totalKilometers = records.reduce((total, record) => total + parseFloat(record.kilometers), 0);
    //     const totalKilometersElement = document.getElementById('total-kilometers');
    //     totalKilometersElement.textContent = `Total de Kilómetros: ${totalKilometers}`;
    // }

    function updateAfterChanges() {
        loadTravelRecords();
        calculateTotalKilometers();
    }
    </script>
</body>
</html>
